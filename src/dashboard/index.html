<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'">
    <link href="./styles.css" rel="stylesheet">
    <title>Jiminy Settings</title>
  </head>
  <body class="bg-white dark:bg-[#111] text-zinc-800 dark:text-zinc-200 font-sans h-screen overflow-hidden">
    <div class="relative h-full w-full flex">
      <!-- Sidebar -->
      <aside class="w-[140px] flex-none bg-zinc-50/90 dark:bg-zinc-900/60 border-r border-zinc-200 dark:border-zinc-800 flex flex-col pt-3 pb-3">
          <div class="px-4 mb-4 flex items-center gap-2">
            <img src="../icon.png" alt="" class="w-5 h-5 rounded-md object-cover shadow-sm">
            <span class="text-sm font-semibold tracking-tight text-zinc-900 dark:text-zinc-100">Jiminy</span>
          </div>

          <nav class="flex-1 px-2 space-y-1" role="tablist" aria-label="Settings Sections">
            <button
              class="sidebar-item"
              data-section-target="wizard"
              data-active="false"
              role="tab"
              aria-controls="section-wizard"
              aria-selected="false"
              type="button"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                <path d="M12 3v3m0 12v3m9-9h-3M6 12H3m14.1-7.1-2.1 2.1M9 15l-2.1 2.1m10.2 0L15 15M9 9 6.9 6.9" />
              </svg>
              Wizard
            </button>
            <button
              class="sidebar-item"
              data-section-target="general"
              data-active="true"
              role="tab"
              aria-controls="section-general"
              aria-selected="true"
              type="button"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                <path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Z" />
                <path d="M19.4 15a1 1 0 0 0 .2 1.1l.1.1a2 2 0 0 1-2.8 2.8l-.1-.1a1 1 0 0 0-1.1-.2 1 1 0 0 0-.6.9V20a2 2 0 0 1-4 0v-.2a1 1 0 0 0-.6-.9 1 1 0 0 0-1.1.2l-.1.1a2 2 0 0 1-2.8-2.8l.1-.1a1 1 0 0 0 .2-1.1 1 1 0 0 0-.9-.6H4a2 2 0 0 1 0-4h.2a1 1 0 0 0 .9-.6 1 1 0 0 0-.2-1.1l-.1-.1a2 2 0 0 1 2.8-2.8l.1.1a1 1 0 0 0 1.1.2 1 1 0 0 0 .6-.9V4a2 2 0 0 1 4 0v.2a1 1 0 0 0 .6.9 1 1 0 0 0 1.1-.2l.1-.1a2 2 0 0 1 2.8 2.8l-.1.1a1 1 0 0 0-.2 1.1 1 1 0 0 0 .9.6H20a2 2 0 0 1 0 4h-.2a1 1 0 0 0-.9.6Z" />
              </svg>
              General
            </button>
            <button
              class="sidebar-item"
              data-section-target="graph"
              data-active="false"
              role="tab"
              aria-controls="section-graph"
              aria-selected="false"
              type="button"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                <circle cx="6" cy="12" r="2" />
                <circle cx="18" cy="6" r="2" />
                <circle cx="18" cy="18" r="2" />
                <path d="M7.8 11.1 16.1 7.1M7.8 12.9 16.1 16.9" />
              </svg>
              Graph
            </button>
            <button
              class="sidebar-item"
              data-section-target="exclusions"
              data-active="false"
              role="tab"
              aria-controls="section-exclusions"
              aria-selected="false"
              type="button"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                <path d="M12 3l7 4v5c0 5-3.5 8-7 9-3.5-1-7-4-7-9V7l7-4Z" />
                <path d="M9.5 12.5 12 15l4-4" />
              </svg>
              Exclusions
            </button>
            <button
              class="sidebar-item"
              data-section-target="hotkeys"
              data-active="false"
              role="tab"
              aria-controls="section-hotkeys"
              aria-selected="false"
              type="button"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                <rect x="3" y="7" width="18" height="10" rx="2" />
                <path d="M7 11h2m2 0h2m2 0h2M7 14h10" />
              </svg>
              Hotkeys
            </button>
            <button
              class="sidebar-item"
              data-section-target="history"
              data-active="false"
              role="tab"
              aria-controls="section-history"
              aria-selected="false"
              type="button"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                <path d="M3 12a9 9 0 1 0 9-9" />
                <path d="M3 3v6h6" />
                <path d="M12 7v5l3 3" />
              </svg>
              History
            </button>
            <button
              class="sidebar-item"
              data-section-target="updates"
              data-active="false"
              role="tab"
              aria-controls="section-updates"
              aria-selected="false"
              type="button"
            >
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                <path d="M12 3v4m0 0 3-3m-3 3-3-3" />
                <path d="M5 11a7 7 0 1 0 14 0" />
                <path d="M12 19v2" />
              </svg>
              Updates
            </button>
          </nav>

          <div class="px-3 mt-auto">
            <p class="text-xs text-zinc-400 dark:text-zinc-500 leading-relaxed">Open this window anytime from the menu bar icon.</p>
          </div>
        </aside>

      <!-- Content Area -->
      <main class="flex-1 flex flex-col h-full bg-white dark:bg-[#111]">
          <div id="settings-header" class="flex-none px-6 py-4 border-b border-zinc-100 dark:border-zinc-800/50 flex justify-between items-center">
            <div>
              <h2 id="section-title" class="text-sm font-semibold tracking-tight text-zinc-900 dark:text-zinc-100">General Settings</h2>
              <p id="section-subtitle" class="text-xs text-zinc-500 dark:text-zinc-400">Core app configuration and sync controls.</p>
            </div>
          </div>

          <div id="settings-content" class="flex-1 overflow-y-auto p-6 space-y-6 scrollbar-slim">
            <!-- General -->
            <section id="section-general" data-section-pane="general" role="tabpanel" aria-label="General settings" class="space-y-6">
              <section class="space-y-2">
                <div class="flex items-center justify-between">
                  <label for="context-folder-path" class="section-label">Primary Context</label>
                  <span id="context-folder-status" data-setting-status="context-folder-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
                </div>
                <div class="input-ring flex items-center gap-2 px-3 py-2.5 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg">
                  <div class="flex items-center justify-center w-6 h-6 rounded-md bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 text-zinc-400">
                    <svg viewBox="0 0 24 24" class="w-3.5 h-3.5" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                      <path d="M3 6.5A2.5 2.5 0 0 1 5.5 4H10l2 2h6.5A2.5 2.5 0 0 1 21 8.5v8A2.5 2.5 0 0 1 18.5 19h-13A2.5 2.5 0 0 1 3 16.5v-10Z" />
                    </svg>
                  </div>
                  <input
                    id="context-folder-path"
                    data-setting="context-folder-path"
                    type="text"
                    placeholder="No folder selected"
                    readonly
                    class="flex-1 bg-transparent text-xs font-medium text-zinc-900 dark:text-zinc-100 placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none"
                  >
                  <button id="context-folder-choose" data-action="context-folder-choose" type="button" class="px-2.5 py-1.5 text-xs font-medium bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-md text-zinc-600 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Change</button>
                </div>
                <p id="context-folder-error" data-setting-error="context-folder-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
              </section>

              <hr class="border-zinc-100 dark:border-zinc-800">

              <section class="space-y-2">
                <label class="section-label">Intelligence</label>
                <div class="space-y-2">
                  <select id="llm-provider" data-setting="llm-provider" class="input-ring w-full appearance-none bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg py-2 px-3 text-xs font-medium text-zinc-900 dark:text-zinc-100 focus:outline-none cursor-pointer">
                    <option value="">Select provider...</option>
                    <option value="gemini">Gemini</option>
                    <option value="openai">OpenAI</option>
                    <option value="anthropic">Anthropic</option>
                  </select>
                  <p id="llm-provider-error" data-setting-error="llm-provider-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
                </div>

                <div class="space-y-2">
                  <div class="input-ring relative w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg">
                      <svg viewBox="0 0 24 24" class="absolute left-3 top-2.5 w-3.5 h-3.5 text-zinc-400" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                        <path d="M14.5 10.5a3.5 3.5 0 1 0-7 0 3.5 3.5 0 0 0 7 0Z" />
                        <path d="M12 14v3m0 0h6m-6 0l2 2m-2-2l2-2" />
                      </svg>
                      <input
                        id="llm-api-key"
                        data-setting="llm-api-key"
                        type="password"
                        placeholder="Not set"
                        autocomplete="off"
                        class="w-full bg-transparent text-xs text-zinc-700 dark:text-zinc-300 placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none py-2 pl-8 pr-3"
                      >
                  </div>
                  <p id="llm-api-key-error" data-setting-error="llm-api-key-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
                  <span id="llm-api-key-status" data-setting-status="llm-api-key-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
                </div>
              </section>
            </section>

            <section id="section-graph" data-section-pane="graph" role="tabpanel" aria-label="Context graph" class="space-y-6 hidden">
              <section class="rounded-xl border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900 p-5 shadow-sm space-y-4">
                <div class="flex items-start justify-between">
                  <div class="space-y-1">
                    <h4 class="text-[10px] font-semibold uppercase tracking-wider text-zinc-500 dark:text-zinc-400">Sync Status</h4>
                    <div class="flex items-baseline gap-2">
                      <span id="context-graph-percent" class="text-2xl font-semibold text-zinc-900 dark:text-zinc-100">0%</span>
                      <span class="text-xs font-medium text-zinc-500 dark:text-zinc-400">synced</span>
                    </div>
                  </div>
                  <div id="context-graph-status-pill" class="flex items-center gap-1.5 px-2 py-0.5 rounded-full bg-emerald-50 dark:bg-emerald-900/20 border border-emerald-100 dark:border-emerald-900/40">
                    <span id="context-graph-status-dot" class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
                    <span id="context-graph-status-label" class="text-[10px] font-medium text-emerald-700 dark:text-emerald-400">Ready</span>
                  </div>
                </div>

                <div class="space-y-2">
                  <div class="h-2 w-full bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden flex">
                    <div id="context-graph-bar-synced" class="h-full bg-emerald-500"></div>
                    <div id="context-graph-bar-pending" class="h-full bg-amber-400 bg-stripe"></div>
                    <div id="context-graph-bar-new" class="h-full bg-blue-500"></div>
                  </div>
                  <div class="flex flex-wrap justify-between items-center gap-2 text-[10px] text-zinc-500 dark:text-zinc-400 font-medium">
                    <span class="flex items-center gap-1">
                      <span class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span>
                      <span id="context-graph-synced-count">0</span> Synced
                    </span>
                    <span class="flex items-center gap-1">
                      <span class="w-1.5 h-1.5 rounded-full bg-amber-400"></span>
                      <span id="context-graph-pending-count">0</span> Pending
                    </span>
                    <span class="flex items-center gap-1">
                      <span class="w-1.5 h-1.5 rounded-full bg-blue-500"></span>
                      <span id="context-graph-new-count">0</span> New
                    </span>
                    <span class="flex items-center gap-1">
                      <span class="w-1.5 h-1.5 rounded-full bg-zinc-400"></span>
                      <span id="context-graph-ignored-count">0</span> Ignored
                    </span>
                  </div>
                </div>

                <div class="flex flex-wrap items-center gap-2">
                  <button id="context-graph-sync" data-action="context-graph-sync" type="button" class="px-3 py-2 text-xs font-semibold bg-indigo-600 hover:bg-indigo-700 border border-indigo-600 hover:border-indigo-700 rounded-lg text-white focus:outline-none transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Sync now</button>
                  <span id="context-graph-status" data-setting-status="context-graph-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
                </div>

                <p id="context-graph-warning" data-setting-status="context-graph-warning" class="text-xs text-amber-600 dark:text-amber-400 hidden" aria-live="polite"></p>
                <p id="context-graph-progress" data-setting-status="context-graph-progress" class="text-xs text-zinc-500 dark:text-zinc-400" aria-live="polite"></p>
                <p id="context-graph-error" data-setting-error="context-graph-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
              </section>

              <section class="space-y-3">
                <div class="flex items-center justify-between px-1">
                  <h4 class="text-[10px] font-semibold uppercase tracking-wider text-zinc-400 dark:text-zinc-500">Manage Data</h4>
                </div>
                <div class="group flex items-center justify-between p-3 rounded-lg border border-zinc-100 dark:border-zinc-800 bg-white dark:bg-zinc-900 hover:border-red-200 dark:hover:border-red-900/40 hover:bg-red-50/30 dark:hover:bg-red-900/10 transition-all">
                  <div class="flex flex-col">
                    <span class="text-xs font-medium text-zinc-700 dark:text-zinc-300 group-hover:text-red-700 dark:group-hover:text-red-400 transition-colors">Prune current path</span>
                    <span class="text-[10px] text-zinc-400 group-hover:text-red-600/70 transition-colors">Discard unsaved nodes</span>
                  </div>
                  <button id="context-graph-prune" data-action="context-graph-prune" type="button" class="w-8 h-8 rounded flex items-center justify-center text-zinc-400 group-hover:text-red-600 group-hover:bg-red-100 dark:group-hover:bg-red-900/30 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" class="w-4 h-4" aria-hidden="true">
                      <path d="M3 6h18" />
                      <path d="M8 6V4h8v2" />
                      <path d="M6 6l1 14h10l1-14" />
                      <path d="M10 10v6" />
                      <path d="M14 10v6" />
                    </svg>
                  </button>
                </div>
                <span id="context-graph-prune-status" data-setting-status="context-graph-prune-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
              </section>
            </section>

            <!-- Exclusions -->
            <section id="section-exclusions" data-section-pane="exclusions" role="tabpanel" aria-label="Excluded paths" class="space-y-4 hidden">
              <div class="flex items-center justify-between">
                <div>
                  <h3 class="text-sm font-semibold text-zinc-900 dark:text-zinc-100">Excluded Paths</h3>
                  <p class="text-xs text-zinc-500 dark:text-zinc-400">Skipped during sync and capture.</p>
                </div>
                <button id="add-exclusion" data-action="add-exclusion" type="button" class="px-3 py-2 text-xs font-semibold bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Add exclusion</button>
              </div>
              <ul id="exclusions-list" data-setting-list="exclusions" class="space-y-2 empty:hidden"></ul>
              <p id="exclusions-error" data-setting-error="exclusions-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
            </section>

            <!-- Updates -->
            <section id="section-updates" data-section-pane="updates" role="tabpanel" aria-label="Updates" class="space-y-4 hidden">
              <div class="flex flex-wrap items-center gap-2">
                <button id="updates-check" data-action="updates-check" type="button" class="px-3 py-2 text-xs font-semibold bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Check for Updates</button>
                <span id="updates-status" data-setting-status="updates-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
              </div>
              <p id="updates-error" data-setting-error="updates-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
            </section>

            <!-- Hotkeys -->
            <section id="section-hotkeys" data-section-pane="hotkeys" role="tabpanel" aria-label="Hotkeys" class="space-y-4 hidden">
              <div>
                <h3 class="text-sm font-semibold text-zinc-900 dark:text-zinc-100">Keyboard Shortcuts</h3>
                <p class="text-xs text-zinc-500 dark:text-zinc-400">Click a field and press your desired key combination.</p>
              </div>

              <div class="space-y-3">
                <div class="flex items-center gap-3">
                  <label for="capture-hotkey" class="text-xs uppercase tracking-wider font-semibold text-zinc-500 dark:text-zinc-400 w-28">Screen Capture</label>
                  <button
                    id="capture-hotkey"
                    type="button"
                    class="hotkey-recorder flex-1 px-3 py-2 text-xs bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg text-zinc-700 dark:text-zinc-300 focus:outline-none font-mono text-left cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors"
                    data-hotkey=""
                    data-hotkey-role="capture"
                  >Click to set...</button>
                </div>
                <div class="flex items-center gap-3">
                  <label for="clipboard-hotkey" class="text-xs uppercase tracking-wider font-semibold text-zinc-500 dark:text-zinc-400 w-28">Clipboard Copy</label>
                  <button
                    id="clipboard-hotkey"
                    type="button"
                    class="hotkey-recorder flex-1 px-3 py-2 text-xs bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg text-zinc-700 dark:text-zinc-300 focus:outline-none font-mono text-left cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors"
                    data-hotkey=""
                    data-hotkey-role="clipboard"
                  >Click to set...</button>
                </div>
              </div>

              <div class="flex flex-wrap items-center gap-2">
                <button id="hotkeys-save" data-action="hotkeys-save" type="button" class="px-3 py-2 text-xs font-semibold bg-indigo-600 hover:bg-indigo-700 border border-indigo-600 hover:border-indigo-700 rounded-lg text-white focus:outline-none transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Save Hotkeys</button>
                <button id="hotkeys-reset" data-action="hotkeys-reset" type="button" class="px-3 py-2 text-xs font-semibold bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer">Reset Defaults</button>
                <span id="hotkeys-status" data-setting-status="hotkeys-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
              </div>
              <p id="hotkeys-error" data-setting-error="hotkeys-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
            </section>

            <section id="section-history" data-section-pane="history" role="tabpanel" aria-label="History" class="space-y-4 hidden">
              <div>
                <h3 class="text-sm font-semibold text-zinc-900 dark:text-zinc-100">History</h3>
                <p class="text-xs text-zinc-500 dark:text-zinc-400">Recent captures and analysis flows.</p>
              </div>
              <p id="history-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
              <p id="history-empty" class="text-xs text-zinc-500 dark:text-zinc-400 hidden" aria-live="polite"></p>
              <div id="history-list" class="space-y-3"></div>
            </section>
          </div>

          <section id="section-wizard" data-section-pane="wizard" role="tabpanel" aria-label="Setup wizard" class="hidden flex-1 flex flex-col min-h-0">
            <div class="flex-none px-6 py-4 border-b border-zinc-100 dark:border-zinc-800/50 flex justify-between items-center">
              <div>
                <h2 class="text-sm font-semibold tracking-tight text-zinc-900 dark:text-zinc-100">Setup Wizard</h2>
                <p class="text-xs text-zinc-500 dark:text-zinc-400">Guided setup in five steps.</p>
              </div>
              <span id="wizard-complete-status" class="text-xs font-medium text-emerald-600 dark:text-emerald-400 hidden">Setup complete</span>
            </div>

            <div class="flex-none px-6 py-4 border-b border-zinc-100 dark:border-zinc-800/40">
              <div class="flex items-center justify-between relative">
                <div class="flex flex-col items-center gap-1.5 relative z-10" data-wizard-step-indicator="1">
                  <div class="w-7 h-7 rounded-full border border-zinc-200 dark:border-zinc-700 text-xs font-semibold text-zinc-500 flex items-center justify-center" data-wizard-step-circle="1">1</div>
                  <span class="text-xs font-medium text-zinc-500" data-wizard-step-label="1">Context</span>
                </div>
                <div class="flex-1 h-px bg-zinc-200 dark:bg-zinc-800 mx-2 relative">
                  <div class="absolute inset-y-0 left-0 bg-indigo-600 w-0 transition-all" data-wizard-step-connector="1"></div>
                </div>
                <div class="flex flex-col items-center gap-1.5 relative z-10" data-wizard-step-indicator="2">
                  <div class="w-7 h-7 rounded-full border border-zinc-200 dark:border-zinc-700 text-xs font-semibold text-zinc-500 flex items-center justify-center" data-wizard-step-circle="2">2</div>
                  <span class="text-xs font-medium text-zinc-500" data-wizard-step-label="2">Exclusions</span>
                </div>
                <div class="flex-1 h-px bg-zinc-200 dark:bg-zinc-800 mx-2 relative">
                  <div class="absolute inset-y-0 left-0 bg-indigo-600 w-0 transition-all" data-wizard-step-connector="2"></div>
                </div>
                <div class="flex flex-col items-center gap-1.5 relative z-10" data-wizard-step-indicator="3">
                  <div class="w-7 h-7 rounded-full border border-zinc-200 dark:border-zinc-700 text-xs font-semibold text-zinc-500 flex items-center justify-center" data-wizard-step-circle="3">3</div>
                  <span class="text-xs font-medium text-zinc-500" data-wizard-step-label="3">Intelligence</span>
                </div>
                <div class="flex-1 h-px bg-zinc-200 dark:bg-zinc-800 mx-2 relative">
                  <div class="absolute inset-y-0 left-0 bg-indigo-600 w-0 transition-all" data-wizard-step-connector="3"></div>
                </div>
                <div class="flex flex-col items-center gap-1.5 relative z-10" data-wizard-step-indicator="4">
                  <div class="w-7 h-7 rounded-full border border-zinc-200 dark:border-zinc-700 text-xs font-semibold text-zinc-500 flex items-center justify-center" data-wizard-step-circle="4">4</div>
                  <span class="text-xs font-medium text-zinc-500" data-wizard-step-label="4">Sync</span>
                </div>
                <div class="flex-1 h-px bg-zinc-200 dark:bg-zinc-800 mx-2 relative">
                  <div class="absolute inset-y-0 left-0 bg-indigo-600 w-0 transition-all" data-wizard-step-connector="4"></div>
                </div>
                <div class="flex flex-col items-center gap-1.5 relative z-10" data-wizard-step-indicator="5">
                  <div class="w-7 h-7 rounded-full border border-zinc-200 dark:border-zinc-700 text-xs font-semibold text-zinc-500 flex items-center justify-center" data-wizard-step-circle="5">5</div>
                  <span class="text-xs font-medium text-zinc-500" data-wizard-step-label="5">Hotkeys</span>
                </div>
              </div>
            </div>

            <div class="flex-1 min-h-0 overflow-y-auto px-6 py-6 scrollbar-slim">
              <div data-wizard-step="1" class="max-w-[360px] mx-auto space-y-5">
                <div class="text-center space-y-1">
                  <h3 class="text-sm font-medium text-zinc-900 dark:text-zinc-100">Choose your primary context folder</h3>
                  <p class="text-xs text-zinc-500 dark:text-zinc-400">Jiminy will store captures and summaries inside this folder.</p>
                </div>
                <section class="space-y-2">
                  <div class="flex items-center justify-between">
                    <label for="wizard-context-folder-path" class="section-label">Primary Context</label>
                    <span id="wizard-context-folder-status" data-setting-status="context-folder-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
                  </div>
                  <div class="input-ring flex items-center gap-2 px-3 py-2.5 bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg">
                    <div class="flex items-center justify-center w-6 h-6 rounded-md bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 text-zinc-400">
                      <svg viewBox="0 0 24 24" class="w-3.5 h-3.5" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                        <path d="M3 6.5A2.5 2.5 0 0 1 5.5 4H10l2 2h6.5A2.5 2.5 0 0 1 21 8.5v8A2.5 2.5 0 0 1 18.5 19h-13A2.5 2.5 0 0 1 3 16.5v-10Z" />
                      </svg>
                    </div>
                    <input
                      id="wizard-context-folder-path"
                      data-setting="context-folder-path"
                      type="text"
                      placeholder="No folder selected"
                      readonly
                      class="flex-1 bg-transparent text-xs font-medium text-zinc-900 dark:text-zinc-100 placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none"
                    >
                    <button id="wizard-context-folder-choose" data-action="context-folder-choose" type="button" class="px-2.5 py-1.5 text-xs font-medium bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-md text-zinc-600 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Change</button>
                  </div>
                  <p id="wizard-context-folder-error" data-setting-error="context-folder-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
                </section>
              </div>

              <div data-wizard-step="2" class="max-w-[360px] mx-auto space-y-5 hidden">
                <div class="text-center space-y-1">
                  <h3 class="text-sm font-medium text-zinc-900 dark:text-zinc-100">Exclude paths you do not want tracked</h3>
                  <p class="text-xs text-zinc-500 dark:text-zinc-400">Add folders or files to skip during sync and capture.</p>
                </div>
                <div class="flex items-center justify-between">
                  <label class="section-label">Exclusions</label>
                  <button id="wizard-add-exclusion" data-action="add-exclusion" type="button" class="px-3 py-2 text-xs font-semibold bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Add exclusion</button>
                </div>
                <ul id="wizard-exclusions-list" data-setting-list="exclusions" class="space-y-2 empty:hidden"></ul>
                <p id="wizard-exclusions-error" data-setting-error="exclusions-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
              </div>

              <div data-wizard-step="3" class="max-w-[360px] mx-auto space-y-5 hidden">
                <div class="text-center space-y-1">
                  <h3 class="text-sm font-medium text-zinc-900 dark:text-zinc-100">Configure Intelligence</h3>
                  <p class="text-xs text-zinc-500 dark:text-zinc-400">Select your model provider and store your API key.</p>
                </div>
                <section class="space-y-2">
                  <label for="wizard-llm-provider" class="section-label">Provider</label>
                  <select id="wizard-llm-provider" data-setting="llm-provider" class="input-ring w-full appearance-none bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg py-2 px-3 text-xs font-medium text-zinc-900 dark:text-zinc-100 focus:outline-none cursor-pointer">
                    <option value="">Select provider...</option>
                    <option value="gemini">Gemini</option>
                    <option value="openai">OpenAI</option>
                    <option value="anthropic">Anthropic</option>
                  </select>
                  <p id="wizard-llm-provider-error" data-setting-error="llm-provider-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
                </section>
                <section class="space-y-2">
                  <label for="wizard-llm-api-key" class="section-label">API Key</label>
                  <div class="input-ring relative w-full bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg">
                      <svg viewBox="0 0 24 24" class="absolute left-3 top-2.5 w-3.5 h-3.5 text-zinc-400" fill="none" stroke="currentColor" stroke-width="1.8" aria-hidden="true">
                        <path d="M14.5 10.5a3.5 3.5 0 1 0-7 0 3.5 3.5 0 0 0 7 0Z" />
                        <path d="M12 14v3m0 0h6m-6 0l2 2m-2-2l2-2" />
                      </svg>
                      <input
                        id="wizard-llm-api-key"
                        data-setting="llm-api-key"
                        type="password"
                        placeholder="Not set"
                        autocomplete="off"
                        class="w-full bg-transparent text-xs text-zinc-700 dark:text-zinc-300 placeholder-zinc-400 dark:placeholder-zinc-500 focus:outline-none py-2 pl-8 pr-3"
                      >
                  </div>
                  <p id="wizard-llm-api-key-error" data-setting-error="llm-api-key-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
                  <span id="wizard-llm-api-key-status" data-setting-status="llm-api-key-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
                </section>
              </div>

              <div data-wizard-step="4" class="max-w-[360px] mx-auto space-y-5 hidden">
                <div class="text-center space-y-1">
                  <h3 class="text-sm font-medium text-zinc-900 dark:text-zinc-100">Sync your context graph</h3>
                  <p class="text-xs text-zinc-500 dark:text-zinc-400">Build the knowledge graph from your selected folder.</p>
                </div>
                <div class="space-y-3">
                  <p id="wizard-context-graph-stats" data-setting-status="context-graph-stats" class="text-xs text-zinc-500 dark:text-zinc-400" aria-live="polite"></p>
                  <div class="flex items-center gap-2">
                    <button id="wizard-context-graph-sync" data-action="context-graph-sync" type="button" class="px-3 py-2 text-xs font-semibold bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Sync now</button>
                    <span id="wizard-context-graph-status" data-setting-status="context-graph-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
                  </div>
                  <p id="wizard-context-graph-progress" data-setting-status="context-graph-progress" class="text-xs text-zinc-500 dark:text-zinc-400" aria-live="polite"></p>
                  <p id="wizard-context-graph-warning" data-setting-status="context-graph-warning" class="text-xs text-amber-600 dark:text-amber-400 hidden" aria-live="polite"></p>
                  <p id="wizard-context-graph-error" data-setting-error="context-graph-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
                </div>
              </div>

              <div data-wizard-step="5" class="max-w-[360px] mx-auto space-y-5 hidden">
                <div class="text-center space-y-1">
                  <h3 class="text-sm font-medium text-zinc-900 dark:text-zinc-100">Review hotkeys</h3>
                  <p class="text-xs text-zinc-500 dark:text-zinc-400">Confirm shortcuts for the tools you will use most.</p>
                </div>
                <div class="space-y-3">
                  <div class="flex items-center gap-3">
                    <label for="wizard-capture-hotkey" class="text-xs uppercase tracking-wider font-semibold text-zinc-500 dark:text-zinc-400 w-28">Screen Capture</label>
                    <button
                      id="wizard-capture-hotkey"
                      type="button"
                      class="hotkey-recorder flex-1 px-3 py-2 text-xs bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg text-zinc-700 dark:text-zinc-300 focus:outline-none font-mono text-left cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors"
                      data-hotkey=""
                      data-hotkey-role="capture"
                    >Click to set...</button>
                  </div>
                  <div class="flex items-center gap-3">
                    <label for="wizard-clipboard-hotkey" class="text-xs uppercase tracking-wider font-semibold text-zinc-500 dark:text-zinc-400 w-28">Clipboard Copy</label>
                    <button
                      id="wizard-clipboard-hotkey"
                      type="button"
                      class="hotkey-recorder flex-1 px-3 py-2 text-xs bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg text-zinc-700 dark:text-zinc-300 focus:outline-none font-mono text-left cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors"
                      data-hotkey=""
                      data-hotkey-role="clipboard"
                    >Click to set...</button>
                  </div>
                </div>
                <div class="flex flex-wrap items-center gap-2">
                  <button id="wizard-hotkeys-save" data-action="hotkeys-save" type="button" class="px-3 py-2 text-xs font-semibold bg-indigo-600 hover:bg-indigo-700 border border-indigo-600 hover:border-indigo-700 rounded-lg text-white focus:outline-none transition-colors cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed">Save Hotkeys</button>
                  <button id="wizard-hotkeys-reset" data-action="hotkeys-reset" type="button" class="px-3 py-2 text-xs font-semibold bg-white dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-zinc-700 dark:text-zinc-300 hover:bg-zinc-100 dark:hover:bg-zinc-700 transition-colors cursor-pointer">Reset Defaults</button>
                  <span id="wizard-hotkeys-status" data-setting-status="hotkeys-status" class="text-xs text-emerald-600 dark:text-emerald-400 hidden" aria-live="polite"></span>
                </div>
                <p id="wizard-hotkeys-error" data-setting-error="hotkeys-error" class="text-xs text-red-600 dark:text-red-400 hidden" role="alert" aria-live="polite"></p>
              </div>
            </div>

            <div class="flex-none px-6 py-4 border-t border-zinc-100 dark:border-zinc-800 flex justify-between items-center bg-zinc-50/70 dark:bg-zinc-900/60">
              <button id="wizard-back" data-action="wizard-back" type="button" class="flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-xs font-medium text-zinc-600 dark:text-zinc-400 hover:bg-white dark:hover:bg-zinc-800 hover:text-zinc-900 dark:hover:text-zinc-200 border border-transparent hover:border-zinc-200 dark:hover:border-zinc-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed">
                Back
              </button>
              <div class="flex items-center gap-2">
                <span id="wizard-step-status" class="text-xs text-zinc-400 hidden"></span>
                <button id="wizard-next" data-action="wizard-next" type="button" class="flex items-center gap-1.5 px-4 py-1.5 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-xs font-medium text-white shadow-sm shadow-indigo-200 dark:shadow-none hover:shadow-md hover:shadow-indigo-500/20 active:translate-y-px transition-all disabled:opacity-50 disabled:cursor-not-allowed">Next</button>
                <button id="wizard-done" data-action="wizard-done" type="button" class="hidden flex items-center gap-1.5 px-4 py-1.5 rounded-lg bg-indigo-600 hover:bg-indigo-700 text-xs font-medium text-white shadow-sm shadow-indigo-200 dark:shadow-none hover:shadow-md hover:shadow-indigo-500/20 active:translate-y-px transition-all">Done</button>
              </div>
            </div>
          </section>
      </main>
    </div>

    <script src="./wizard.js"></script>
    <script src="./exclusions.js"></script>
    <script src="./hotkeys.js"></script>
    <script src="./history.js"></script>
    <script src="./updates.js"></script>
    <script src="./settings.js"></script>
    <script src="./graph.js"></script>
    <script src="./renderer.js"></script>
  </body>
</html>
